define(["backbone","backbone-forms","backbone-forms-list"],function(e){var t=e.Form,n=t.editors;return t.setTemplates({nestedForm:'<div class="bbf-nested-form">{{fieldsets}}</div>'}),n.List.InlineNestedModel=n.List.NestedModel.extend({events:{},initialize:function(e){n.Base.prototype.initialize.call(this,e),delete this.options.item.events["keydown input[type=text]"];var t=this.schema;if(!t.model)throw'Missing required option "schema.model"';this.nestedSchema=t.model.prototype.schema,_.isFunction(this.nestedSchema)&&(this.nestedSchema=this.nestedSchema());var r=e.list;r.on("add",this.onUserAdd,this)},render:function(){var e=this;return this.$el.html(this.getFormEl()),setTimeout(function(){e.trigger("readyToAdd")},0),this},getFormEl:function(){var e=this.schema,n=this.getValue();return n||(n=new e.model),this.form=new t({template:"nestedForm",model:n}),this.form.render().el},getValue:function(){return this.form&&(this.value=this.form.getValue()),this.value},onUserAdd:function(){this.form.$("input, textarea, select").first().focus()}}),e});